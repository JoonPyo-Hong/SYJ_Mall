<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mybatis를 통해 db연동 -->
<mapper namespace="SYJDB">
	
	
	<!-- 로그인 검증과정 -->
	<select id="loginVerification" resultType="com.test.SYJ_Mall.login.LoginDTO" parameterType="java.util.HashMap" statementType="CALLABLE" >
		declare @user_seq int
		declare @login_code int
		exec dbo.qoo10_total_login #{userIp}, #{id}, #{encpw}, @login_code output, @user_seq output
		select @login_code as loginCode, @user_seq as userSeq 
	</select>
	
	
	<!-- 광고처리 -->
	<select id="advertiseShow" resultType="com.common.utill.AdverDTO" statementType="CALLABLE" >
		{
			call dbo.advertise_show
		}
	</select>
	
	<!-- 유저정보 가져와주기 -->
	<select id="userInfoDetail" resultType="com.test.SYJ_Mall.login.UserDTO" statementType="CALLABLE" >
		{
			call dbo.qoo10_user_info (#{userSeq})
		}
	</select>
	
	<!-- 자동로그인 거친 후 회원의 로그인 시간,아이피 기록 -->
	<update id="autoAfterTrace" parameterType="java.util.HashMap" statementType="CALLABLE">
		{
			call dbo.qoo10_login_after_auto_check(#{ipaddress},#{userSeq})
		}
	</update>
	
	<!-- 회원가입 -->
	<select id="qooSignUpsp" resultType="Integer" parameterType="com.test.SYJ_Mall.login.SignUpDTO" statementType="CALLABLE" >
		
		declare @result int
		exec dbo.qoo_sign_up #{qoouser_id},#{qoouser_pw},#{qoouser_birthday},#{qoouser_email},#{qoouser_gender},
							 #{qoouser_nation}, #{qoouser_ipaddress}, #{qoouser_phone_num}, #{qoouser_receive_email},
							 #{qoouser_receive_sms}, #{qoouser_name}, @result output
		select @result
		
	</select>
	
	<!-- 회원 이메일 체크 -->
	<select id="userSignUpIdCheck" resultType="Integer" parameterType="String" statementType="CALLABLE" >
		
		declare @result int
		exec dbo.qoo_sign_up_id_check #{inputId},@result output
		select @result
		
	</select>
	
	
	<select id="userEmailIdCheck" resultType="Integer" parameterType="String" statementType="CALLABLE" >
		
		declare @result int
		exec dbo.kakao_sign_up_email_check #{fullEmail},@result output
		select @result
		
	</select>
	
	

</mapper>